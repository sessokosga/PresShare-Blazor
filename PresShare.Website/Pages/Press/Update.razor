@page "/press/update/{id:int}"

@using PresShare.Website.Api
@using PresShare.DataModel.Lib

@inject PressProcessor pressProcess
@inject NavigationManager NavManager

@if (saving)
{
    <p>Saving...</p>
}
else
{
    @if (press == null)
    {
        <p>Loading...</p>
    }
    else
    {
        title = press.title;
        content = press.content;

            <h2>Edit a Press </h2>
        <EditForm class="form-press" Model="@press" OnValidSubmit="@Save">
            <div class="form-press-left">
                <InputText id="title" minlength="1" maxlength="25" required placeholder="" type="text" @bind-Value="@press.title"></InputText>
                <InputTextArea minlength="2" required cols="30" rows="5" id="content" @bind-Value="@press.content" placeholder="Contenu du Press"></InputTextArea>
            </div>
            <div class="form-press-right">
                <InputSelect id="genre" @bind-Value="@press.genre">
                    <option value="Text">Texte</option>
                    <option value="Link">Lien</option>
                </InputSelect>
                <br />
                <input class="del-add" type="reset" value="Reset">
                <input class="del-add" type="submit"  value="Save">
            </div>

            @* <div class="form-press">
    <div class="form-press-left">
    <label for="title">Title :</label>
    <input @bind-value="@title"  type="text" id="title" name="title"
    placeholder="Enter titre" /><br>

    <label for="content">Content :</label>
    <textarea @bind="@content" minlength="2" required id="content" name="content" placeholder="Contenu du Press"
    cols="30" rows="5">
    @((MarkupString)content.Replace("\n", "<br>"))
    </textarea><br>
    </div>
    <div class="form-press-right">
    <label for="genre">Genre :</label>
    <select required id="genre" name="genre">
    @if (press.genre == "Text")
    {
    <option selected value="Text">Texte</option>
    <option value="Link">Lien</option>
    }
    else
    {
    <option value="Text">Texte</option>
    <option selected value="Link">Lien</option>
    }
    </select><br>
    <input class="del-add" type="reset" value="Reset">
    <input class="del-add" type="submit" @onclick="@Save" value="Save">
    </div>
    </div> *@
        </EditForm>
    }
}
@code {
    [Parameter]
    public int id { get; set; }
    private PressModel? press = null;
    private string title, content;
    protected override async Task OnInitializedAsync()
    {
        press = await pressProcess.LoadPress(id);

    }
    private bool saving = false;

    private async Task Save()
    {   
        saving = true;
         if(await pressProcess.Update(press)){
            NavManager.NavigateTo("/");
        } 
    }
}